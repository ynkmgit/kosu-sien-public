{% extends "base.html" %}
{% from 'macros/page_header.html' import page_header %}
{% from 'macros/forms.html' import loading_row, form_card_header, add_button %}
{% block title %}プロジェクト一覧{% endblock %}
{% block content %}
{{ page_header(
    title='プロジェクト一覧',
    icon='M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10',
    breadcrumbs=[
        {'label': 'プロジェクト一覧'}
    ]
) }}

<div class="form-card">
    {{ form_card_header('新規プロジェクト追加') }}
    <form class="add-form" hx-post="/projects" hx-target="#project-table tbody" hx-swap="beforeend" hx-on::after-request="this.reset()">
        <div class="form-group">
            <label class="form-label">CD</label>
            <input type="text" name="cd" placeholder="PJ001" required class="form-input input-cd">
        </div>
        <div class="form-group">
            <label class="form-label">プロジェクト名</label>
            <input type="text" name="name" placeholder="プロジェクト名を入力" required class="form-input">
        </div>
        <div class="form-group">
            <label class="form-label">説明</label>
            <input type="text" name="description" placeholder="プロジェクトの説明" class="form-input">
        </div>
        {{ add_button() }}
    </form>
</div>

<div class="table-card">
    <div class="table-header">
        <span class="table-title">登録済みプロジェクト</span>
        <input type="search" name="q" placeholder="検索..." class="search-input"
               hx-get="/projects/list" hx-trigger="keyup changed delay:300ms"
               hx-target="#project-table" hx-swap="innerHTML">
    </div>
    <table id="project-table" hx-get="/projects/list?sort=cd&order=asc" hx-trigger="load" hx-target="#project-table" hx-swap="innerHTML">
        <thead>
            <tr>
                <th class="col-cd">CD</th>
                <th class="col-name">名前</th>
                <th>説明</th>
                <th class="col-actions">操作</th>
            </tr>
        </thead>
        <tbody>
            {{ loading_row(4) }}
        </tbody>
    </table>
</div>
{% endblock %}
